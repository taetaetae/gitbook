# 1. 단위 테스트의 목표

* 단위 테스트에 시간을 투자할 때는 항상 최대한 이득을 얻도록 노력해야 한다. (테스트에 드는 노력을 가능한 한 줄이고 그에 따르는 이득을 최대화)
* 단위테스트의 양이 중요하지 않다. 단위 테스트 기술의 차이가 프로젝트 진행에 큰 영향을 준다.

## 1.1 단위 테스트 현황

* 단위테스트의 중요함은 어느정도 전파 되었지만 좋은 단위 테스트를 작성하는것은 어떤 의미인가?는 아직 혼란스럽다.
* 새로운 기능을 구현하는 데 오래 걸리고, 이미 구현되고 반영된 기능에 새로운 버그가 지속적으로 나타나며, 구현했던 단위테스트는 커버가 안되는 → 테스트가 상황을 더 나쁘게 할 수 있다.

## 1.2 단위 테스트의 목표

* 단위테스트 활동이 더 나은 설계로 이어지는건 사실이지만 단지 좋은 부수 효과일뿐 단위 테스트의 주목표는 아니다.
* 단위테스트의 목표는? <mark style="background-color:red;">**소프트웨어 프로젝트의 지속 가능한 성장을 가능하게 하는 것.**</mark>

<figure><img src="../../.gitbook/assets/image (4).png" alt=""><figcaption><p>테스트가 없는 프로젝트의 경우 시작은 유리하지만, 이내 진척이 없을 정도로 느려진다.</p></figcaption></figure>

* 코드는 점점 나빠지는 경향이 있다. 엔트로피(시스템 내 무질서도)는 코드베이스에서 무언가를 변경할 때마다 품질을 떨어뜨리는 코드의 형태로 나타난다.&#x20;
* 하나의 버그를 수정하면 더 많은 버그를 양산하게 되는 도미노 현상 발생. 코드베이스를 신뢰하기 어렵게 되고 최악의 경우 안정되게 복구하기 어렵다.
* 테스트로 이러한 경향을 뒤집을 수 있다. 안전망 역할을 하며 회귀(=코드 수정 이후 기능이 의도한 대로 작동하지 않는 경우, a.k.a 버그) 에 대한 보험을 제공하는 도구.&#x20;
* 초반에 (어쩌면 상당한) 노력이 필요할 수 있다. 하지만 장기적으로 보면 그 비용을 메울 수 있다.

<figure><img src="../../.gitbook/assets/image (2).png" alt="" width="376"><figcaption><p>테스트가 좋은지 나쁜지에 따른 프로젝트 간 성장 추이의 차이. <br>테스트가 잘못 작성된 프로젝트는 초반 에는 테스트가 잘 작성된 프로젝트의 속성을 보여주지만, 결국 침체 단계에 빠진다.</p></figcaption></figure>

* 테스트를 작성하는 것만으로는 충분하지 않다. 좋은 테스트가 포함되어야 한다.
* 테스트코드가 많을수록 좋은건 아니다. 오히려 버그에 노출되는 표면적이 넓어지고 유지비용이 늘어난다. 가능한 한 적은 코드로 문제를 해결하는것이 좋다.

## 1.3 테스트 스위트 품질 측정을 위한 커버리지 지표

* 커버리지의 숫자가 목표가 되어선 안된다.
  * 테스트 스위트? 테스트 케이스(여기서 이것은 하나의 메소드를 테스트하기 위한 테스트 메소드를 의미)들을 하나로 묶은 것
* <mark style="background-color:red;">커버리지 지표는</mark> <mark style="background-color:red;"></mark><mark style="background-color:red;">**괜찮은 부정 지표**</mark> <mark style="background-color:red;"></mark><mark style="background-color:red;">이지만</mark> <mark style="background-color:red;"></mark><mark style="background-color:red;">**좋지 않은 긍정 지표**</mark><mark style="background-color:red;">다.</mark>
  * 단위 테스트를 할 수 없는 코드는 품질이 좋지 않음
  * 단위 테스트를 할 수 있다고 품질을 보증하지는 않음
* 코드 커버리지
  * 테스트가 실행하는 라인 수 / 전체 라인 수
  * 코드의 리팩토링으로 의도치 않게 코드 커버리지를 증가 시킬수 있다.&#x20;
  * 코드가 작을수록 테스트 커버리지 지표가 좋아지는 한계 발생
* 분기 커버리지
  * 코드 커버리지의 단점을 극복
  * 테스트가 실행하는 경우의 수 / 전체 경우의 수
* 커버리지 지표에 관한 문제점
  * 커버리지 지표가 모든 결과를 검증한다고 보증할 수 없음
  * 외부 라이브러리의 상황까지 고려할 수 없음 (고려하면 안됨)
* 특정 커버리지 숫자를 목표로 하게 되면 단위테스트의 목표를 달성하기 힘들다. (= 커버리지 숫자를 증가시키려는 것에만 방법을 강구)

## 1.4 무엇이 성공적인 테스트 스위트를 만드는가?

* 개발주기에 통합 : CI 등 자동화 파이프라인
* 코드베이스에서 가장 중요한 부분만을 대상
* 최소 유지비로 최대 가치를 끌어냄
  * 가치있는 테스트(더 나아가, 가치가 낮은 테스트)를 식별하고&#x20;
  * 가치있는 테스트를 작성하기
* 단위 테스트의 목표를 달성하기 위한 유일한 방법
  * 좋은 테스트와 좋지 않은 테스트를 구별하는 방법을 배운다.
  * 테스트를 리팩터링해서 더 가치있게 만든다.
